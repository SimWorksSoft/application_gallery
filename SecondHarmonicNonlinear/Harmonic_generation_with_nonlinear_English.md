---
title: Harmonic Generation with Nonlinear Materials
description: In nonlinear optics, the interaction between light and media produces nonlinear polarization. Second-order nonlinear effects are widely used in optical frequency doubling, frequency mixing, and modulation, which play an important role in lasers, frequency conversion and other devices. This example will simulate the generation of second harmonic using second-order nonlinear materials.
language: en-US
businessId: harmonic-generation-with-nonlinear-materials
keywords: Finite Difference Time Domain(FDTD),Nonlinear optics,Second harmonic
coverImg: https://simworksofficial-files.oss-cn-beijing.aliyuncs.com/jpg/nonlinear_chi2_structures_20231215095819A241.jpg
---

# Preface

In nonlinear optics, the interaction between light and media produces nonlinear polarization, and the relationship between the nonlinear polarization intensity P and the electric field component E of light is:

$$\pmb{P}=\varepsilon_0\chi^{(1)}\cdot\pmb{E}+\varepsilon_0\chi^{(2)}\cdot\pmb{E}^2+\varepsilon_0\chi^{(3)}\cdot\pmb{E}^3+\cdot\cdot\cdot$$

where $\chi^{(1)}$, $\chi^{(2)}$, $\chi^{(3)}$ are the linear susceptibility, second-order nonlinear susceptibility, and third-order nonlinear susceptibility of the medium, respectively. Ignoring terms of third-order and higher-order, this equation is the expression for the polarization intensity of a second-order nonlinear material. Second-order nonlinear effects are widely used in optical frequency doubling, frequency mixing, and modulation, which play an important role in lasers, frequency conversion and other devices. This example will simulate the generation of second harmonic using second-order nonlinear materials.

# Simulation settings

This example is simulated by 2D FDTD. A plane wave source is incident on a nonlinear material ($\chi_2$), and the transmitted spectral information is received behind the material. The structure is shown below. The `Periodic` boundary condition is used in the z-direction to simulate infinity in that direction.

![nonlinear_chi2_structures](https://simworksofficial-files.oss-cn-beijing.aliyuncs.com/mdfile/resources/img/nonlinear_chi2_structures.png)

When defining the second-order nonlinear material ($\chi_2$) in the material library, it is necessary to set the `Base Material` and the nonlinear susceptibility coefficient. When the base material is not selected, the default material is air with refractive index 1. For details, please refer to [Nonlinear Material](/localhost/knowledge-base/User-Manual_nonlinear-material). The nonlinear susceptibility coefficient should satisfy the following equation:

$$\chi^{(2)}E<<\chi^{(1)}$$

The pulse shape of the light source is vital for the nonlinear simulation. In this example, a customized pulse signal is set in the `Time Domain`, as shown below. At the same time, increase the amplitude of the light source to obtain a stronger nonlinear effect.

![nonlinear_chi2_plane_source_time_signal](https://simworksofficial-files.oss-cn-beijing.aliyuncs.com/mdfile/resources/img/nonlinear_chi2_plane_source_time_signal.png)

It is worth noting that the `Continuous Wave Normalization` feature needs to be turned off in the nonlinear simulation. When it is turned on, the received field will be normalized using the Fourier transform of the time pulse of the source to obtain the frequency domain response of the system. However, this process is only accurate for linear effects.

Under the default non-uniform mesh, the mesh size is automatically calculated based on the wavelength range of the simulated source. However, this can lead to insufficient mesh refinement due to the neglect of the high-frequency component generated by nonlinear effects. By using the `override bandwidth for mesh generation` setting, select a custom wavelength range (including short wavelengths created by nonlinearity) to re-partition the mesh so that it meets the simulation needs. In the `TimeMonitor`, the default number of samples should be increased to prevent insufficient sampling of high-frequency components generated by nonlinear effects.

# Simulation results

At the accessory project, the spectrum transformed by Fourier transformation can be obtained in the time monitor (see the figure below). The results show that the received spectrum has resonance peaks not only at 200 THz inherent frequency of the source, but also at the subsequent frequencies, e.g., 400, 600 and 800 THz. It indicates that the second harmonic is generated when light interacts with the nonlinear material.

![E_spectrum](https://simworksofficial-files.oss-cn-beijing.aliyuncs.com/mdfile/resources/img/nonlinear_chi2_E_spectrum_log10.png)![H_spectrum](https://simworksofficial-files.oss-cn-beijing.aliyuncs.com/mdfile/resources/img/nonlinear_chi2_H_spectrum_log10.png)
